# findorf ORF Prediction Results Report

```{r, echo=FALSE}
library(knitr)
library(ggplot2)
source("orf-analysis.R")

d <- importGTF("out.gtf")

# verify some aspects of annotation
stopifnot(sum(table(d$has_orf)) == nrow(d)) # has_orf defined for all contigs
````

## Totals

How many subjects have relative blastx hits?

```{r relatives}
p <- ggplot(d) + geom_bar(aes(x=has_relatives, fill=has_relatives), width=1)
p <- p + scale_x_discrete("contig has relative blastx hits")
p + opts(legend.position = "none") 
````

How many subjects with relative blastx hits have full length, or
missing start/stop, ORFs?

```{r full-length}
p <- ggplot(subset(d, has_relatives))
p <- p + geom_bar(aes(x=status, fill=status), position="dodge") 
p + scale_x_discrete("") + opts(title="ORF Status for Contigs with Relative BLASTX Hits")
````

Breakdown of same plot with look at annotation:

```{r full-length-annotation}
p <- ggplot(subset(d, has_relatives))
p <- p + geom_bar(aes(x=status, fill=alt_status), position="dodge") + scale_fill_discrete(name="annotation")
p + scale_x_discrete("") + opts(title="ORF Status for Contigs with Relative BLASTX Hits")
````
